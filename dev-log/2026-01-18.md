# Dev log 2026-01-18

## Progress
- Added crawler sources for Hokkaido Univ (GFC API), AIST (PDF list pages), and Kyushu Univ (equipment list HTML tables).
- Wired new sources into the crawler CLI with `--source` options: `hokudai`, `aist`, `kyushu`, and `all`.
- Added `pdfplumber` dependency to parse AIST equipment list PDFs.
- Updated crawler README with new run examples.
- Ran dry-run crawls for each source and fixed AIST equipment ID matching.
- Unescaped HTML entities during text normalization to clean Hokkaido locations.
- Fixed Hokkaido pagination duplication because the API returns all records in one response.
- Created Firestore database in `asia-northeast1` and ran production upsert.
- Enabled Firestore API and created composite indexes for `prefecture + category_general` and `external_use + prefecture`.

## Notes
- Hokkaido list is fetched via `https://www.gfc.hokudai.ac.jp/system/gfc_apparatus_list/list` with paging.
- AIST list PDFs are discovered from the ORP page and parsed per-table.
- Kyushu list extracts equipment name, location, contact, and notes; detail links become `source_url`.

## Validation
- Dry-run outputs created for `hokudai`, `aist`, and `kyushu` (limit=5) and spot-checked for key fields.
- Full dry-run outputs created (hokudai=1475, aist=362, kyushu=500).
- Production upsert results: created=1935, updated=402 (total 2337).
- Firestore doc counts by org: 北海道大学=1115, 九州大学=498, 産業技術総合研究所=322.

## Next steps
- Run dry-run crawls for each source and inspect JSONL output quality.
- Tune AIST PDF parsing if new PDF formats appear (headers or extra columns).
- Decide how to enrich address/prefecture for AIST records if needed.
- Run a first Firestore upsert (non-dry) after validation.
