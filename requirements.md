## 研究設備共用システム 要件定義書および開発計画

## 背景・目的

大学や公的研究機関が保有する高度な研究設備の多くは、常時100%活用されているわけではありません。一方で、自機関にない設備を必要とする企業や他大学の研究者も存在しています。本システムは、そうした研究設備の情報を集約し、学外の利用希望者が検索・閲覧できるポータルを提供することを目的としています。これにより **未利用の研究設備を有効活用** し、研究資源の共有による新たな共同研究の促進や設備利用効率の向上を図ります。

本システムでは、日本全国の大学等（国公私立大学、研究所など）の共用研究設備に関するデータを収集し、外部利用の可否や利用条件、料金などの情報とともに公開します。利用者は地域や設備カテゴリで検索し、興味のある設備の詳細情報や所在場所（住所）を確認した上で、設備提供元のページへアクセスして手続きを進めることができます。開発にあたっては、 **最新のAPIやGoogleサービス** の情報も確認し、最新の技術に基づいた実装計画とします。

## 対象範囲と除外

- **対象**: 国立研究機関（国立研究開発法人等）、国立大学、公立大学、私立大学、高等専門学校などの **公的機関が保有する研究設備** を対象とします。
- **除外**: 企業研究所など **民間の研究機関が保有する機器** は対象外とします。データ収集時に機関種別を判定し、民間・営利企業の設備は収集/公開しません。
- **除外（運用）**: 設備一覧がPDFのみ、または閲覧にログインが必要なページは自動収集対象外とし、HTML/CSV/JSONで代替取得できる場合のみ収集します。
- **優先度**: 収集着手の優先順位は「国立研究機関 ＞ 国立大学 ＞ 私立大学 ＞ 高等専門学校」とします（具体的な対象サイトは後述）。

## データ設計

本システムで扱うデータ項目は、事前に提示されたスキーマ案に基づき、必要に応じて拡張・調整しています。データはGoogle Cloud Firestore(NoSQLデータベース)上に保存し、1つの\*\*「equipment」コレクション\*\*に各設備のドキュメントを持つ構成とします。各ドキュメント（設備）には以下のフィールドを保持します（ **太字** がフィールド名、括弧内は日本語説明）:

- **`equipment_id`** （内部ID）: システム内での設備レコードのユニークIDです。Firestoreでは自動生成IDを用いるか、このフィールドを主キー相当として付与します。各設備に一意の値となり、他データからの参照にも利用可能です。
- **`name`** （機器名）: 設備の名称です。具体的な装置の名前や型番を含みます（例：「JEM-2100 透過型電子顕微鏡」など）。ユーザにはこの名前で設備を識別してもらいます。
- **`category_general`** / **`category_detail`** （カテゴリ大分類/詳細分類）: 設備のカテゴリを「一般名称 ＞ 詳細名称」の階層形式で表します。例えば一般名称を「顕微鏡」、詳細名称を「電子顕微鏡」といった形でデータに保持し、画面上では「顕微鏡 ＞ 電子顕微鏡」のように表示します。カテゴリはあらかじめ定めた分類リストに基づき、データ収集時に各設備を対応付けます（表記揺れのないよう統一）。
- **`org_name`** （所属機関名）: 当該設備を保有する大学・研究機関等の名称です。例：「〇〇大学〇〇研究所」など。
- **`org_type`** （機関種別）: 機関の種別を表します。例えば「国立大学」「公立大学」「私立大学」「公的研究機関」等の分類を想定しています。機関名から自動推定するか、リストによって付与します。
- **`prefecture`** （都道府県）: 機器設置場所の都道府県名です。基本的には所属機関の所在地都道府県を指します（例：「山形県」）。地域での検索・絞り込みに利用します。
- **`address_raw`** （所在地住所）: 機器の設置場所の具体的な住所です。データソースから取得できる場合はその値を保存し、取得できない場合は所属機関の住所（本部所在地など）を代理として用います。住所データは公的な大学住所データセットやジオコーディングAPIを用いて取得します（例えば、全国の大学所在地リストには大学名と住所・緯度経度が含まれており研究・商用利用可能です [amano-tec.com](https://amano-tec.com/data/univs.html#:~:text=2023%E5%B9%B4%EF%BC%88%E4%BB%A4%E5%92%8C5%E5%B9%B4%EF%BC%891%E6%9C%881%E6%97%A5%E7%8F%BE%E5%9C%A8%E3%81%AE%E6%97%A5%E6%9C%AC%E5%9B%BD%E5%86%85%E5%A4%A7%E5%AD%A6813%E6%A0%A1%EF%BC%8C%E7%9F%AD%E5%A4%A7306%E6%A0%A1%EF%BC%8C%E5%A4%A7%E5%AD%A6%E6%A0%A17%E6%A0%A1%EF%BC%8C%E8%A8%881%2C126%E6%A0%A1%E3%81%AE%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E4%B8%80%E8%A6%A7%E3%83%87%E3%83%BC%E3%82%BF%E3%81%A7%E3%81%99%E3%80%82%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E3%81%A8%E3%81%97%E3%81%A6%E4%B8%BB%E3%81%AB%E5%A4%A7%E5%AD%A6%E6%9C%AC%E9%83%A8%E3%82%92%E6%9C%89%E3%81%99%E3%82%AD%E3%83%A3%20%E3%83%B3%E3%83%91%E3%82%B9%E3%81%BE%E3%81%9F%E3%81%AF%E5%BB%BA%E7%89%A9%E3%82%92%E3%82%B8%E3%82%AA%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82%E5%B1%9E%E6%80%A7%E9%A0%85%E7%9B%AE%E3%81%AF%E9%80%A3%E7%95%AA%EF%BC%8C%E7%A7%91%E5%AD%A6%E7%A0%94%E7%A9%B6%E8%B2%BB%E5%8A%A9%E6%88%90%E4%BA%8B%E6%A5%AD%E3%81%AB%E4%BF%82%E3%82%8B%E6%A9%9F%E9%96%A2%E7%95%AA%E5%8F%B7%EF%BC%88%E5%A4%A7%E5%AD%A6%E7%95%AA%E5%8F%B7%EF%BC%89%EF%BC%8C%E6%96%87%E9%83%A8%E7%A7%91%E5%AD%A6%E7%9C%81%E5%AD%A6%E6%A0%A1%E3%82%B3%E3%83%BC%E3%83%89%EF%BC%8C%E5%A4%A7%E5%AD%A6%E5%90%8D%EF%BC%8C%E8%8B%B1%E8%AA%9E%E5%A4%A7%E5%AD%A6%E5%90%8D%EF%BC%8C%E9%83%B5%E4%BE%BF%E7%95%AA%E5%8F%B7%EF%BC%8C%20%E4%BD%8F%E6%89%80%EF%BC%8C%E9%9B%BB%E8%A9%B1%E7%95%AA%E5%8F%B7%EF%BC%8CURL%EF%BC%8C%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E5%90%8D%EF%BC%8C%E5%82%99%E8%80%83%EF%BC%8C%E7%B7%AF%E5%BA%A6%EF%BC%8C%E7%B5%8C%E5%BA%A6%EF%BC%8C%E4%BD%8F%E6%89%80%E3%81%AE%E5%8F%82%E7%85%A7%E5%85%83%E3%81%A7%E3%81%99%E3%80%82%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E5%90%8D%E3%81%AF1%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E7%A9%BA%E7%99%BD%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99%E3%80%82%E9%9B%BB%E8%A9%B1%E7%95%AA%E5%8F%B7%E3%81%AF%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%E3%81%8C%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AF%20%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%EF%BC%8C%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%E3%81%8C%E3%81%AA%E3%81%84%E3%81%BE%E3%81%9F%E3%81%AF%E4%B8%8D%E6%98%8E%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E7%B7%8F%E5%8B%99%EF%BC%8C%E5%BA%B6%E5%8B%99%EF%BC%8C%E5%BA%83%E5%A0%B1%E3%81%AE%E9%A0%86%E3%81%AB%E8%A9%B2%E5%BD%93%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%82%92%E8%A8%98%E8%BC%89%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82) ）。本住所情報により、単なる地域名だけでなく具体的所在地までユーザに提示します。
- **`external_use`** （学外利用可否）: 当該設備を学外者（他大学や企業等）が利用できるかの区分です。値は「可」「要相談」「不可」「不明」のいずれかとなります。データ収集元で明示されている学外利用の可否情報をそのまま反映します [yamaguchi-u.ac.jp](https://www.yamaguchi-u.ac.jp/facility/sharing/guest/#:~:text=%E3%81%BE%E3%81%9F%E3%80%81%E5%90%84%E6%96%BD%E8%A8%AD%E3%81%AE%E3%83%9B%E3%83%BC%E3%83%A0%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E3%81%94%E7%A2%BA%E8%AA%8D%E3%81%84%E3%81%9F%E3%81%A0%E3%81%8D%E3%80%81%E6%96%BD%E8%A8%AD%E3%81%AB%E7%9B%B4%E6%8E%A5%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E3%81%84%E3%81%9F%E3%81%A0%E3%81%8F%E3%81%93%E3%81%A8%E3%82%82%E5%8F%AF%E8%83%BD%E3%81%A7%E3%81%99%E3%80%82) 。「可」は原則誰でも利用可能、「要相談」は条件次第で利用可能（問い合わせ要）、「不可」は学内専用、「不明」は情報なしの場合です。
- **`fee_band`** （料金区分）: 設備利用料金の区分です。「無料」「有料」「不明」のいずれかを設定します。例えば「無料」の場合、学外利用者でも基本無料で利用可能な設備を示します。「有料」の場合、何らかの利用料が発生することを示し、具体的金額や条件は後述の `fee_note` に記載します。「不明」は料金に関する情報がソース上明記されていない場合です。
- **`fee_note`** （料金詳細）: 利用料金に関する補足テキストです。料金額やその条件等を記述します（例：「◯◯大学所属者以外は1時間あたり5,000円」など）。料金体系が複雑な場合や、試料消耗品費等についてもこちらに記載します。
- **`conditions_note`** （利用条件等）: 利用にあたっての条件や注意事項の詳細テキストです。例えば「事前に担当教員の承認が必要」「要技術講習受講」「○週間前までに予約要」など、学外者が利用する際の条件が記載されます [yamaguchi-u.ac.jp](https://www.yamaguchi-u.ac.jp/facility/sharing/guest/#:~:text=%E3%81%BE%E3%81%9F%E3%80%81%E5%90%84%E6%96%BD%E8%A8%AD%E3%81%AE%E3%83%9B%E3%83%BC%E3%83%A0%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E3%81%94%E7%A2%BA%E8%AA%8D%E3%81%84%E3%81%9F%E3%81%A0%E3%81%8D%E3%80%81%E6%96%BD%E8%A8%AD%E3%81%AB%E7%9B%B4%E6%8E%A5%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E3%81%84%E3%81%9F%E3%81%A0%E3%81%8F%E3%81%93%E3%81%A8%E3%82%82%E5%8F%AF%E8%83%BD%E3%81%A7%E3%81%99%E3%80%82) 。データソースに記載の条件情報をそのまま保存します。
- **`source_url`** （情報源URL）: 当該設備の詳細情報ページへの外部リンクURLです。ユーザがこのリンクをクリックすると、元の提供機関のページ（設備詳細や申込方法が書かれたページ）に遷移できるようにします。例えば大学の設備一覧ページや予約システムの該当ページへの誘導URLとなります。
- **`crawled_at`** （クロール日時）: 本システムがその設備データを **最終取得した日時** です。これは本システム内でのデータ更新日として表示に用い、「更新日」としてユーザに提示します。定期クローラーが実行された日時であり、データの新鮮さを示す指標となります。
- **`source_updated_at`** （情報源更新日）: データソース側で提示されている更新日時です。例えば元ページに「最終更新日：2024年4月1日」等の記載がある場合にその日付を保存します。取得できた場合のみこのフィールドを設定し、画面上は「（情報元最終更新日：YYYY/MM/DD）」のように補足表示します。取得不能な場合や情報源に更新日記載が無い場合、このフィールドはnullもしくは設定なしとします。
- **`dedupe_key`** （重複判定キー）: 重複エントリ検出のためのキーです。複数のデータソースを統合する際、同一の設備が異なるソースに現れる可能性があります。その場合に同一機器と判断するため、 `dedupe_key` を\*\*機関名＋設備名称（＋カテゴリ）\*\*等から生成します。例えば「山形大学-電子顕微鏡-12345」のように組み合わせやハッシュにした文字列を想定しています。このキーで既存レコードとの照合を行い、重複する場合は新規ではなく既存レコードを更新する運用とします。なお、データソースが単一で重複の心配がない場合や、内部IDで十分一意性を保証できる場合は、このフィールドは省略することも可能です。

**Firestore上のデータ構造** はシンプルに、上記フィールドを含むドキュメントを各設備ごとに保持します。機関（大学）情報も各ドキュメント内に重複して持たせていますが、これはFirestoreがRDBのようなテーブル結合（JOIN）をサポートしておらず、関連データはドキュメント内に埋め込むなど **非正規化** して持つことが推奨されるためです [zenn.dev](https://zenn.dev/yucatio/articles/173f386c471398#:~:text=%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%81%AEjoin%20%3A%20%C3%97) 。この設計により、クライアント（フロントエンド）からのクエリ一発で必要な情報をすべて取得でき、問い合わせ回数の削減と実装の簡易化を図っています。

また、Firestoreは各フィールドに対し自動でインデックスを作成します。 `prefecture` や `category_general` などでの検索・絞り込みを行うため、必要に応じて複合インデックス（例えば「prefecture + category\_general」の組み合わせ検索用）を設定します。データ件数が増えても高速に検索・取得できるよう、インデックス設計にも注意します。

**データ例**: 例えば、一件のドキュメントは以下のような内容を持ちます。

※上記は架空の例ですが、このように **1レコード＝1設備** に関するすべての情報がまとまっている設計です。

## 機能要件

本システムが提供すべき主な機能を、データ更新機能とユーザ向け閲覧機能に分けて定義します。

### データ収集・更新機能

- **自動データ収集（クローリング）**: システムは定期的にデータソース（設備情報を掲載する各種ウェブサイト）から最新の設備情報を取得します。対象となるのは、各大学・公的研究機関の共用機器公開ページや、機関が公開するCSV/Excelデータなどです。例えば、設備ごとに学外利用可否や問い合わせ方法等が記載されています [yamaguchi-u.ac.jp](https://www.yamaguchi-u.ac.jp/facility/sharing/guest/#:~:text=%E3%81%BE%E3%81%9F%E3%80%81%E5%90%84%E6%96%BD%E8%A8%AD%E3%81%AE%E3%83%9B%E3%83%BC%E3%83%A0%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E3%81%94%E7%A2%BA%E8%AA%8D%E3%81%84%E3%81%9F%E3%81%A0%E3%81%8D%E3%80%81%E6%96%BD%E8%A8%AD%E3%81%AB%E7%9B%B4%E6%8E%A5%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E3%81%84%E3%81%9F%E3%81%A0%E3%81%8F%E3%81%93%E3%81%A8%E3%82%82%E5%8F%AF%E8%83%BD%E3%81%A7%E3%81%99%E3%80%82) 。こうした情報源に対しクローラー（スクレイピングスクリプト）を実行し、設備名・カテゴリ・機関・利用可否・料金・条件等の項目を抽出します。
	- JS必須のポータルは、HTML/JSONの取得が可能な場合のみ対象とし、ヘッドレスブラウザが必須な場合は後回しにします。
- **データ統合と重複排除**: 複数の情報源から収集する場合、同一設備が複数サイトに登場する可能性があります。クローリング時に前述の `dedupe_key` を生成し、Firestore上に既に存在するキーと照合することで、重複データは新規ではなく既存ドキュメントを **更新** します。一方、新規の `dedupe_key` であれば新しいドキュメントとして **追加** します。この処理により、データの一意性を担保し、ユーザに同じ設備が重複表示されることを防ぎます。
- **所在地情報の付加**: データ収集時、取得元に住所情報が無い場合は、機関名から所在地住所を補完します。具体的には、あらかじめ用意した大学・研究機関の住所録データを参照したり、GoogleのジオコーディングAPI等で機関名から住所検索を行います。例えば「山形大学」の住所（山形県山形市〇〇）をデータベースから取得し、当該設備の `address_raw` に設定します [amano-tec.com](https://amano-tec.com/data/univs.html#:~:text=2023%E5%B9%B4%EF%BC%88%E4%BB%A4%E5%92%8C5%E5%B9%B4%EF%BC%891%E6%9C%881%E6%97%A5%E7%8F%BE%E5%9C%A8%E3%81%AE%E6%97%A5%E6%9C%AC%E5%9B%BD%E5%86%85%E5%A4%A7%E5%AD%A6813%E6%A0%A1%EF%BC%8C%E7%9F%AD%E5%A4%A7306%E6%A0%A1%EF%BC%8C%E5%A4%A7%E5%AD%A6%E6%A0%A17%E6%A0%A1%EF%BC%8C%E8%A8%881%2C126%E6%A0%A1%E3%81%AE%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E4%B8%80%E8%A6%A7%E3%83%87%E3%83%BC%E3%82%BF%E3%81%A7%E3%81%99%E3%80%82%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E3%81%A8%E3%81%97%E3%81%A6%E4%B8%BB%E3%81%AB%E5%A4%A7%E5%AD%A6%E6%9C%AC%E9%83%A8%E3%82%92%E6%9C%89%E3%81%99%E3%82%AD%E3%83%A3%20%E3%83%B3%E3%83%91%E3%82%B9%E3%81%BE%E3%81%9F%E3%81%AF%E5%BB%BA%E7%89%A9%E3%82%92%E3%82%B8%E3%82%AA%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82%E5%B1%9E%E6%80%A7%E9%A0%85%E7%9B%AE%E3%81%AF%E9%80%A3%E7%95%AA%EF%BC%8C%E7%A7%91%E5%AD%A6%E7%A0%94%E7%A9%B6%E8%B2%BB%E5%8A%A9%E6%88%90%E4%BA%8B%E6%A5%AD%E3%81%AB%E4%BF%82%E3%82%8B%E6%A9%9F%E9%96%A2%E7%95%AA%E5%8F%B7%EF%BC%88%E5%A4%A7%E5%AD%A6%E7%95%AA%E5%8F%B7%EF%BC%89%EF%BC%8C%E6%96%87%E9%83%A8%E7%A7%91%E5%AD%A6%E7%9C%81%E5%AD%A6%E6%A0%A1%E3%82%B3%E3%83%BC%E3%83%89%EF%BC%8C%E5%A4%A7%E5%AD%A6%E5%90%8D%EF%BC%8C%E8%8B%B1%E8%AA%9E%E5%A4%A7%E5%AD%A6%E5%90%8D%EF%BC%8C%E9%83%B5%E4%BE%BF%E7%95%AA%E5%8F%B7%EF%BC%8C%20%E4%BD%8F%E6%89%80%EF%BC%8C%E9%9B%BB%E8%A9%B1%E7%95%AA%E5%8F%B7%EF%BC%8CURL%EF%BC%8C%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E5%90%8D%EF%BC%8C%E5%82%99%E8%80%83%EF%BC%8C%E7%B7%AF%E5%BA%A6%EF%BC%8C%E7%B5%8C%E5%BA%A6%EF%BC%8C%E4%BD%8F%E6%89%80%E3%81%AE%E5%8F%82%E7%85%A7%E5%85%83%E3%81%A7%E3%81%99%E3%80%82%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E5%90%8D%E3%81%AF1%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E7%A9%BA%E7%99%BD%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99%E3%80%82%E9%9B%BB%E8%A9%B1%E7%95%AA%E5%8F%B7%E3%81%AF%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%E3%81%8C%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AF%20%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%EF%BC%8C%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%E3%81%8C%E3%81%AA%E3%81%84%E3%81%BE%E3%81%9F%E3%81%AF%E4%B8%8D%E6%98%8E%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E7%B7%8F%E5%8B%99%EF%BC%8C%E5%BA%B6%E5%8B%99%EF%BC%8C%E5%BA%83%E5%A0%B1%E3%81%AE%E9%A0%86%E3%81%AB%E8%A9%B2%E5%BD%93%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%82%92%E8%A8%98%E8%BC%89%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82) 。これにより、地域（都道府県）だけでなく具体的な所在地までデータに反映します。
- **定期更新**: クローリングは **定期スケジュール** で実行し、常に最新情報を保持します。更新頻度は月1回程度を目安とします（必要に応じて頻度調整）。例えば毎月1日に全データソースを巡回し、新規設備の追加・既存設備情報の更新を行います。更新処理後には各レコードの `crawled_at` を更新し、ソース側に更新日が明示されていれば `source_updated_at` も合わせて更新します。
- **削除・廃止機器の反映**: 情報源から削除された機器は、本システム上からも除去または非表示にします。具体的には、クローリング時に **今回取得できなかった既存レコード** を特定し、一定期間（例: 次回更新まで）経過しても再取得されない場合は削除します。こうすることで、既に提供終了となった設備がいつまでも掲載されるのを防ぎます。
- **データ検証**: 取得したデータに対し、必須項目の欠損チェックや値の形式チェックを行います。不正なデータ（例: 外部利用可否が未設定など）があれば、ログに警告を出し、可能なら補正します。カテゴリ名や機関名の表記ゆれも、内部でマッピングテーブルを用いて統一します。
- **エラーハンドリング**: クローリング処理で情報源サイトの構造変更や通信エラーが発生した場合、処理をスキップまたはリトライし、管理者に通知します（ログ出力やメール通知など）。これにより、データ更新が一部失敗してもシステム全体が停止しないようにし、早期に原因調査・修正ができる体制を整えます。

### 検索・閲覧機能（ユーザ向け機能）

- **設備検索・一覧表示**: 利用者はウェブアプリ上で登録された設備を検索・閲覧できます。トップページまたは検索ページには、絞り込み検索のUIを提供します。主な検索軸は以下のとおりです:
	- **キーワード検索**: 機器名や機関名でのテキスト検索。ユーザがキーワードを入力すると、その文字列を含む機器名・機関名を持つ設備を検索します（部分一致検索については後述の実装方法参照）。
	- **カテゴリでの絞り込み**: 大分類（例えば「分析装置」「測定装置」「顕微鏡」など）の選択肢を用意し、選んだカテゴリに属する設備のみを一覧表示します。必要に応じて詳細分類でも絞り込めます。カテゴリは内部的に `category_general` や `category_detail` フィールドで管理されているので、Firestoreのクエリで該当カテゴリのものを取得します。
	- **地域での絞り込み**: 都道府県あるいは地方（「関東」「関西」等）の選択で絞り込みができます。例えば「東北」を選べば東北地方（青森～福島）の各県に所在する設備のみ表示、といった動作です。内部的には `prefecture` フィールドでフィルタリングします。複数都道府県をまたぐ地方検索の場合は、クライアント側で対象県のリストを持ち、複数条件クエリを発行するか、あるいは一旦全件取得してクライアント側でフィルタします。
	- **地域別分析**: 検索条件に対して都道府県/地方別の件数サマリーや割合を表示し、任意の地域の設備分布を俯瞰できるようにします。
	- **利用可否/料金でのフィルタ**: 追加のフィルタオプションとして「学外利用：可のみ表示」や「無料設備のみ表示」なども提供します。例えば「外部利用＝可」でフィルタすれば、 `external_use` が「可」の設備だけが一覧になります。同様に「無料」フィルタは `fee_band` が「無料」のものに限定します。複数条件の同時指定も可能です（Firestoreでは複合インデックスが必要になりますが、主要な組み合わせはあらかじめ作成して対応します）。
- **一覧UI**: 検索結果や一覧表示は、見やすいカード形式またはテーブル形式で提示します。各設備の **主要情報** （名称、カテゴリ、所在地（都道府県市区町村程度）、機関名、外部利用可否、料金帯など）をひと目で分かるよう表示します。例えばカード上部に機器名、下部に「カテゴリ：顕微鏡 > 電子顕微鏡」「所在地：山形県山形市」「利用：学外利用可」「料金：有料」等をアイコンやラベル付きで表示します。情報が多い場合はレイアウトを工夫し、アイコンや略号を用いてコンパクトにまとめます（例：「👥外部利用: 可」「¥利用料金: 有料」などの表示）。
- **UI/UXデザイン指針**: 賃貸物件検索サイトのように「地域で探す」「条件で絞る」を主軸にした導線を採用します。サイトの雰囲気は https://nani.now/ja や https://comfy.maison/ を参考にし、余白・タイポグラフィ・カード/グリッド表現を上質にまとめます。
- **詳細表示**: ユーザが一覧から特定の設備を選択すると、 **詳細ページまたはモーダル** でその設備の全情報を閲覧できます。詳細表示にはデータ設計で列挙した全項目を含みます。具体的には:
	- 機器名（大型の文字で表示）、カテゴリ（「顕微鏡 ＞ 電子顕微鏡」の形式）、所属機関名（機関種別も併記、例：「山形大学（国立大学）」など）。
	- 所在地の住所（都道府県＋以降の住所）。住所はテキスト表示するとともに、「地図で見る」リンクを付与します。リンクをクリックするとGoogle Mapsが別タブで開き、その住所の地図を表示できるようにします（Google Mapsの地図埋め込みや静的地図APIの利用も今後検討可能ですが、まずはリンクのみ提供）。
	- 学外利用可否、料金区分等は目立つようにピクトグラムや色分けで表示します（例えば「外部利用: 可」は緑色ラベル、「不可」は灰色など）。
	- 利用条件と料金詳細については、箇条書きや段落で文章をそのまま表示します。ユーザが注意事項を詳細に確認できるよう、可能なら強調表示（例: 「要予約」「要講習」など太字）します。
	- **更新日時情報**: ページ下部などに「最終更新日：YYYY年MM月DD日（情報元更新日：YYYY年MM月DD日）」のような注記を表示します。前者は `crawled_at` から、後者は `source_updated_at` からそれぞれ日付形式にフォーマットして表示します。これにより情報の新鮮さと出典の更新状況を利用者に示します。
	- **出典リンク**: 「詳細・申し込みは情報提供元サイトへ」といった誘導テキストとともに、 `source_url` へのリンクボタンを設置します。ユーザが設備提供元の公式ページにワンクリックで飛べるようにし、本システムでは問い合わせや予約受付は行わず **案内所的な役割** に徹します。
- **ユーザビリティ・応答性**: 検索やフィルタ操作に対して、UIは速やかに反応し結果を更新します。Firestoreからのデータ取得はクエリベースで行い、大量データを逐次ロードするアプローチ（無限スクロールやページネーション）を採用します。例えば初期表示では一部データのみ取得し、スクロールに応じて追加読み込みするか、もしくはフィルタ条件確定時にサーバ側クエリで絞り込んで取得します。これにより、常に数千件のデータを全てブラウザに持たせるのではなく、必要な範囲のみ読み込むことで **軽快な動作** を実現します。
- **部分一致検索への対応**: Firestoreはデフォルトで前方一致や部分一致の全文検索をサポートしていません [zenn.dev](https://zenn.dev/yucatio/articles/173f386c471398#:~:text=%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%81%AEjoin%20%3A%20%C3%97) （LIKE句相当のクエリ不可）。そのため、キーワード検索の実現方法としては以下のいずれかを採用します:
	1. **簡易実装**: 名前や機関名に関しては **完全一致または前方一致** のみサポートし、「含む」検索は行わない。例えばキーワード「顕微鏡」で検索した場合、「電子顕微鏡」はヒットするが「顕微鏡（走査型）」のような部分は拾わない。ただし、この場合ユーザに検索のコツを表示する（例: 「正式名称の一部しか分からない場合はカテゴリフィルタを併用してください」等）。
	2. **クライアントサイドフィルタ**: 一定件数以内であれば、一旦関連するデータをクライアントに読み込み、JavaScript側で部分一致フィルタリングする方法。例えば「顕微鏡」と入力されたら、カテゴリgeneralが「顕微鏡」または名前に「顕微鏡」を含む全アイテム（最大数を制限する）を取得し、JSでフィルタする。
	3. **検索サービスの活用**: 将来的にはAlgolia等の外部全文検索サービスや、Firestoreの拡張機能（公式のElasticsearch連携など）を利用し、部分一致やランキング機能を持つ検索を導入することも検討します。ただし初期リリースでは上記の簡易な方法で十分実用性を確保します。
- **レスポンシブ対応**: 当システムはWebアプリとして **PC・タブレット・スマートフォン対応** のインターフェースを提供します。画面レイアウトはレスポンシブデザインを採用し、画面幅に応じてカードのカラム数を変えたり、詳細ページもモバイルでは縦長スクロール、PCでは余白を活用した見やすい配置にします。文字サイズやボタン配置も、タップ操作しやすいよう調整します。
- **多言語対応（将来的検討）**: 現状データの大半は日本語であり、主な利用者も国内想定のためUIは日本語で提供します。ただし将来的に海外からの利用希望者に対応する場合や、データソースに英語情報が付与されている場合、英語UIへの切替機能を検討します。Firebaseは多言語対応も容易なため、必要になった段階で実装可能です。

### 管理・運用機能

- **管理者によるデータ管理**: 本システムは基本的に自動クローリングでデータ更新しますが、管理者（開発者）は必要に応じてデータの確認・修正を行えるようにします。Firebaseコンソール上でFirestoreデータを直接編集可能なので、小規模な修正（例えば機器名の表記ミスの訂正など）はコンソール経由で実施できます。件数が多い場合や頻繁な修正が必要な場合には、将来的に管理者向けの簡易編集UIを作成することも検討します。
- **セキュリティと認可**: 一般ユーザからはデータの **閲覧のみ許可** し、書き込み操作は許されないようにFirestoreのセキュリティルールを設定します。具体的には「 `equipment` コレクションは読み取り：許可（誰でも可）、書き込み：禁止」とします。ただし管理者またはシステム内部からはデータ更新できるよう、クローリング処理ではFirebaseの管理者権限（Admin SDK）またはクラウド関数を利用し、このセキュリティルールをバイパスします。これにより外部から直接データを書き換えられるリスクを防ぎます。
- **ログとモニタリング**: システム運用上、クローラーの実行状況やエラーはログとして記録・監視します。特にクラウド環境（Cloud Functions等）で動かす場合、デフォルトでログが蓄積されるため定期的に確認し、エラー発生時には通知が来るように設定します。長期的にはSlackやメールへのアラート送信、あるいはダッシュボードでの可視化を導入し、クローリングが正常に動作しているか、データ件数に急激な変化がないか（例: データ源の仕様変更で大量にレコードが消失する等）を把握します。
- **パフォーマンス**: FirestoreとFirebaseホスティングにより、数千件規模のデータと同時アクセスにも耐えうる設計ですが、必要に応じてFirestoreの読み取り最適化（不要なデータの除外、適切なインデックス設計）やキャッシュの活用を行います。Firestoreはスケーラブルな設計のため、現在想定されるデータ量では **十分な応答性能** を発揮できます。また、フロントエンドでの検索・フィルタも適切にクエリを絞って行うことで、通信量と描画負荷を低減します。例えばユーザが特定県を選択した段階でサーバからその県のデータのみ取得することで、無駄な読み込みを避けます。
- **容量管理**: Firestoreの料金プラン上、一定量までは無料枠で運用可能ですが、将来的にデータ増加やアクセス増による課金が発生する場合は、予めコスト試算を行い必要に応じた対応（データのアーカイブ化やプラン変更）を検討します。ただし本システムのデータ量・アクセス規模では当面無料枠内に収まる見込みです。

## 非機能要件

- **信頼性**: Firestoreをデータ基盤として採用することで、データの高い可用性と耐久性を確保します。Firebaseはマルチリージョンに冗長化されたインフラ上に構築されており、機器故障や障害発生時にもデータが失われたり長時間アクセス不能になるリスクを低減できます。また、定期クローリングによりデータの最新性を保つため、利用者は常に信頼できる情報を得られます。
- **性能・スケーラビリティ**: 前述のように、NoSQLデータベースであるFirestoreは読み取り性能に優れ、自動インデックスにより数千件規模の検索にもミリ秒単位で応答可能です。将来的に設備件数や利用者数が増大した場合でも、FirestoreとFirebase Hostingの組み合わせは自動的にスケールします。そのため、特定の同時接続ユーザ数やデータ件数の上限にハードコードされた制約はありません。ただし、大量アクセス時のコスト増加に留意し、必要ならFirestoreデータを静的サイトジェネレータで定期出力するなどの対策も検討可能です。
- **セキュリティ**: 本システムでは公開可能な設備情報のみを扱い、機密性の高い個人データ等は含みません。しかし、不正なデータ改ざんやスパム的なアクセスを防ぐための対策を講じます。具体的には、前述のFirestoreセキュリティルール設定、Firebase Authenticationを用いた管理者認証（将来的に管理画面実装時に導入）、およびクライアント側からの過度な連続リクエストに対する制限（必要であればFirestoreの利用制限やCloud Functions側での処理間隔制御）などです。また、外部APIキー（Google Maps Geocoding APIキー等）を使用する場合、これらはフロントには公開せずクラウド関数内やサーバ側環境変数で安全に管理します。
- **拡張性と保守性**: コードは見通しよくモジュール化し、将来的な機能拡張に耐えられる構成にします。例えば、データ取得ロジックは情報源ごとにモジュール化し、新たな情報源（別の研究設備データベース等）が追加になっても既存構造に影響を与えず組み込めるようにします。UI側もコンポーネント指向で実装し、新しい検索フィルタ（例: 機器メーカーでの絞り込み等）の追加やレイアウト変更が容易にできるようにします。
- **可観測性**: 運用段階でシステムの状態を把握しやすくするため、ログ収集・エラートラッキングを導入します。Firebase Hosting上のフロントエンドについてはGoogle Analytics等で利用状況を把握し、Cloud Functionsについてはエラー時に通知が飛ぶように設定します。これにより、ユーザの利用状況や潜在的な問題点を定量的に把握し、継続的な改善に役立てます。
- **ユーザサポート**: システム上に問い合わせ先や使い方ガイドを設置します。例えば「このサイトについて」ページに、本システムのデータ出典や更新頻度、問い合わせ用メールアドレス（管理者連絡先）を記載し、利用者からの質問や不具合報告を受け付けられるようにします。これも非機能要件の一つ（ユーザ支援）として考慮します。
- **法令遵守**: 本システムで収集・公開する情報は各大学等が公式に公開している情報に限ります。スクレイピングで取得する際も、公開情報の範囲内で利用し、必要に応じて情報源へのクレジット表示やリンク（ `source_url` による誘導）を適切に行います。これにより知的財産権や利用規約の順守に努めます。また、データに含まれる連絡先等の個人情報は各機関が公開を許可した内容のみであり、プライバシー侵害がないことを確認します。

## 開発計画

上記の要件を実現するための開発計画を示します。本計画では、使用技術選定から実装ステップ、テスト・デプロイまで、一連の開発プロセスを具体的に記載します。この計画を参照すれば、開発者がすぐに作業に取りかかれるレベルの詳細さを意図しています。

### 全体アーキテクチャと技術選定

- **アーキテクチャ概要**: 本システムは **サーバレスアーキテクチャ** を基盤とした3層構成です。（1）データベース層としてFirebaseの **Cloud Firestore** を使用、（2）データ収集を行う **バックエンド処理** はCloud FunctionsもしくはCloud Run上で動作するスクレイピングスクリプト、（3）ユーザに情報を提供する **フロントエンド** はシングルページアプリケーション（SPA）としてFirebase Hostingから配信します。専用のアプリケーションサーバは設置せず、フロントエンドから直接Firestoreへクエリを投げる形を取ります（Firebase SDK利用）。これによりサーバ管理の手間を省きつつ、リアルタイムデータ取得やセキュリティルールによる簡易な保護を実現します。
- **使用技術**:
	- **データベース**: *Cloud Firestore (Firebase)* – スケーラブルなNoSQLデータベースで、自動インデックスとリアルタイムリスナー機能を備えます。本システムでは主に読み取りが中心であり、Firestoreは読み取り性能と開発速度に優れているため適しています [zenn.dev](https://zenn.dev/yucatio/articles/173f386c471398#:~:text=%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%81%AEjoin%20%3A%20%C3%97) 。また、無料枠が十分広く、小規模プロジェクト開始時のコストも抑えられます。
	- **バックエンド**: *スクレイピングクローラ* – PythonまたはNode.jsで実装します。PythonはRequestsやBeautifulSoupなど強力なHTMLパースライブラリが利用可能なため、クローリングに向いています。一方でFirebaseのCloud Functionsにデプロイする場合はNode.jsが標準的です。ここでは、 **Python + Cloud Run** の構成を提案します。Pythonでスクレイピングスクリプトを実装し、それをDockerコンテナ化してCloud Run（またはCloud Schedulerで定期起動するCloud Functions（Node.jsでHTTP呼出））でスケジュール実行します。チームのスキルセットに応じては、Node.jsでCloud Functionsとして実装しても問題ありません。
	- **フロントエンド**: *React (JavaScript)* – モダンなSPAフレームワークとしてReactを採用します。Reactはコンポーネントベースで開発しやすく、Firebaseとの統合にも公式ライブラリ（Firebase SDK for JS、React用フックなど）が揃っています。UIライブラリにはMaterial-UI(MUI)などを用いて、レスポンシブかつ統一感のあるデザインを迅速に構築します。代替としてVue.js + Vuetifyを用いる選択肢もありますが、いずれにせよ **コンポーネント指向フレームワーク** を使う方針です。
	- **クラウドインフラ**: *Firebase & Google Cloud Platform* – Firebaseプロジェクトを作成し、その中でFirestoreデータベース、Firebase Hosting、（必要に応じ）Firebase Functionsを利用します。Cloud Scheduler（GCP）とCloud Functions (or Cloud Run)を組み合わせて **定期バッチ処理** を構成します。開発・検証環境と本番環境でFirebaseプロジェクトを分け、データの誤更新を防ぎます。
	- **地図・ジオコーディング**: *Google Maps Geocoding API* – 機関名から住所や座標を取得するために利用します。Google Cloud PlatformのAPIを有効化しAPIキーを取得して、バックエンドのスクリプトからHTTPリクエストでジオコーディングを行います。1日の利用回数は大学数程度（数百件）であり、Googleの無料利用枠内（1ヶ月あたり数万リクエストまで無料相当）に収まる見込みです。取得した住所・緯度経度はFirestoreに保存し、繰り返しAPIを呼ぶ無駄を避けます。なお、オープンデータとして公開されている大学住所データ [amano-tec.com](https://amano-tec.com/data/univs.html#:~:text=2023%E5%B9%B4%EF%BC%88%E4%BB%A4%E5%92%8C5%E5%B9%B4%EF%BC%891%E6%9C%881%E6%97%A5%E7%8F%BE%E5%9C%A8%E3%81%AE%E6%97%A5%E6%9C%AC%E5%9B%BD%E5%86%85%E5%A4%A7%E5%AD%A6813%E6%A0%A1%EF%BC%8C%E7%9F%AD%E5%A4%A7306%E6%A0%A1%EF%BC%8C%E5%A4%A7%E5%AD%A6%E6%A0%A17%E6%A0%A1%EF%BC%8C%E8%A8%881%2C126%E6%A0%A1%E3%81%AE%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E4%B8%80%E8%A6%A7%E3%83%87%E3%83%BC%E3%82%BF%E3%81%A7%E3%81%99%E3%80%82%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E3%81%A8%E3%81%97%E3%81%A6%E4%B8%BB%E3%81%AB%E5%A4%A7%E5%AD%A6%E6%9C%AC%E9%83%A8%E3%82%92%E6%9C%89%E3%81%99%E3%82%AD%E3%83%A3%20%E3%83%B3%E3%83%91%E3%82%B9%E3%81%BE%E3%81%9F%E3%81%AF%E5%BB%BA%E7%89%A9%E3%82%92%E3%82%B8%E3%82%AA%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82%E5%B1%9E%E6%80%A7%E9%A0%85%E7%9B%AE%E3%81%AF%E9%80%A3%E7%95%AA%EF%BC%8C%E7%A7%91%E5%AD%A6%E7%A0%94%E7%A9%B6%E8%B2%BB%E5%8A%A9%E6%88%90%E4%BA%8B%E6%A5%AD%E3%81%AB%E4%BF%82%E3%82%8B%E6%A9%9F%E9%96%A2%E7%95%AA%E5%8F%B7%EF%BC%88%E5%A4%A7%E5%AD%A6%E7%95%AA%E5%8F%B7%EF%BC%89%EF%BC%8C%E6%96%87%E9%83%A8%E7%A7%91%E5%AD%A6%E7%9C%81%E5%AD%A6%E6%A0%A1%E3%82%B3%E3%83%BC%E3%83%89%EF%BC%8C%E5%A4%A7%E5%AD%A6%E5%90%8D%EF%BC%8C%E8%8B%B1%E8%AA%9E%E5%A4%A7%E5%AD%A6%E5%90%8D%EF%BC%8C%E9%83%B5%E4%BE%BF%E7%95%AA%E5%8F%B7%EF%BC%8C%20%E4%BD%8F%E6%89%80%EF%BC%8C%E9%9B%BB%E8%A9%B1%E7%95%AA%E5%8F%B7%EF%BC%8CURL%EF%BC%8C%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E5%90%8D%EF%BC%8C%E5%82%99%E8%80%83%EF%BC%8C%E7%B7%AF%E5%BA%A6%EF%BC%8C%E7%B5%8C%E5%BA%A6%EF%BC%8C%E4%BD%8F%E6%89%80%E3%81%AE%E5%8F%82%E7%85%A7%E5%85%83%E3%81%A7%E3%81%99%E3%80%82%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E5%90%8D%E3%81%AF1%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E7%A9%BA%E7%99%BD%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99%E3%80%82%E9%9B%BB%E8%A9%B1%E7%95%AA%E5%8F%B7%E3%81%AF%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%E3%81%8C%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AF%20%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%EF%BC%8C%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%E3%81%8C%E3%81%AA%E3%81%84%E3%81%BE%E3%81%9F%E3%81%AF%E4%B8%8D%E6%98%8E%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E7%B7%8F%E5%8B%99%EF%BC%8C%E5%BA%B6%E5%8B%99%EF%BC%8C%E5%BA%83%E5%A0%B1%E3%81%AE%E9%A0%86%E3%81%AB%E8%A9%B2%E5%BD%93%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%82%92%E8%A8%98%E8%BC%89%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82) も活用し、API利用を最小限にとどめる計画です。
	- **開発ツール**: *Git & GitHub* – ソースコード管理にGitを用い、GitHub上でリポジトリを運用します。複数開発者で作業する場合はブランチ戦略を定め（例: mainブランチとdevelopブランチ、トピックブランチで機能開発）、プルリクエストでコードレビューを行います。また、 **Issue管理** にGitHub Issuesやプロジェクトボードを活用してタスクの見える化と進捗管理を行います。
	- **テスト**: *Jest等（ユニットテスト）* – 必要に応じ、データ処理部分にはユニットテストを導入します。例えばスクレイピングのパーサーが特定のHTML入力に対して期待通りの出力フィールドを生成するか、といったテストを書くことで、情報源サイト変更時の不具合を検知しやすくします。フロントエンドはReact Testing Libraryによるコンポーネントテストや、主要なユーザ操作の統合テストを検討します。ただしリソースと優先度に応じて、まずは手動テスト中心で進め、必要部分のみ自動化する方針とします。
	- **モニタリング**: *Firebase Crashlytics / Cloud Monitoring* – フロントエンドで予期せぬエラーが発生した際に収集するため、CrashlyticsのWeb版やSentryなどを組み込むことも検討します。バックエンドはCloud Monitoringで関数のエラー率や実行時間を監視します。

以上の技術スタックにより、 **最新のGoogleプラットフォーム** をフル活用した開発を行います。続いて、具体的な開発手順をステップごとに示します。

### 開発手順 (ステップバイステップ)

1. **プロジェクトセットアップ**
	- Firebaseコンソールで新規プロジェクトを作成します（プロジェクト名例: "research-equip-share"）。併せてFirestoreデータベースを有効化し、リージョンを選択します（東京リージョンなどアジア東部を推奨）。
	- Firestoreのセキュリティルールを設定します。初期段階では開発しやすいように読み書き許可を広めに設定し、リリース前に「読み取り:許可、書き込み:認証ユーザのみ（または完全禁止）」となるよう変更します。
	- Gitリポジトリを用意し、ローカルにFirebase CLIをインストールします。 `firebase init` コマンドでFirestoreとHosting、Functions（必要なら）をセットアップし、プロジェクトにリンクします。
	- 開発環境で利用するAPIキーや設定情報（Google Maps APIキー、Firebase設定）を整理し、`.env` ファイルやFirebase環境設定に登録します。開発用と本番用でプロジェクトを分ける場合、それぞれに別の環境変数を設定します。
2. **データスキーマ定義とFirestore構築**
	- Firestore上に `equipment` コレクションを作成し、サンプルデータをいくつか登録します。例えば上記データ例をもとに **テストレコード** を手動追加し、スキーマの整合性を確認します。必要に応じてサブコレクション（例えば組織コレクション）を検討しましたが、当面は単一コレクションで十分なため、導入しません。
	- カテゴリ分類や機関種別など、 **マスタデータ** に相当するリストを準備します。カテゴリについては想定される大分類・詳細分類の一覧をExcel等で整理し、機器名との対応関係（例えば「NMR装置」は「分析機器 > NMR」に属する 等）を定義します。機関種別については大学種別リスト（国立大学法人一覧、公立大学一覧、私立大学一覧）を収集しておきます。これらはスクレイピング時に利用する他、フロントエンドでフィルタ選択肢表示にも使うため、Firestore内にコレクションとして保持するか、フロント側に静的に持たせるか検討します（件数少ないので静的実装でも可）。
	- Firestoreの **インデックス** 設定を行います。まず単一フィールドについてはデフォルトでインデックスがあるためOKです。複合インデックスとして作成が予想されるものは、例として「prefecture + category\_general」「external\_use + prefecture」等をプロビジョニングします。これは実際にクエリを実行してFirestoreのエラーメッセージから必要なインデックスを確認しつつ追加する形で進めます。Firebaseコンソールのインデックス画面から事前定義も可能です。
3. **情報源リサーチとクローラ設計**
	- データ収集対象となる情報源を確定します。主な候補は以下です:  
		a. **各大学・公的研究機関の公開情報**: 例として京都大学「学外の研究者も利用できる設備」ページ [kyoto-u.ac.jp](https://www.kyoto-u.ac.jp/ja/research/resource/equipment#:~:text=%E5%AD%A6%E5%A4%96%E3%81%AE%E7%A0%94%E7%A9%B6%E8%80%85%E3%82%82%E5%88%A9%E7%94%A8%E3%81%A7%E3%81%8D%E3%82%8B%E8%A8%AD%E5%82%99%20) や東京大学「共用研究設備一覧」ページなど、機関ごとに公開している一覧があります。こうしたページからも情報が取得できます。これらはHTML構造が機関ごとに異なるため、個別のパーサが必要ですが、「学外利用可否」「料金」などの記載フォーマットは概ね似通っていると想定します。  
		b. **Excel/CSV提供**: 山口大学の例では「共用機器は **こちら（Excel形式）** 」というリンクがありました [yamaguchi-u.ac.jp](https://www.yamaguchi-u.ac.jp/facility/sharing/guest/#:~:text=%E5%B1%B1%E5%8F%A3%E5%A4%A7%E5%AD%A6%E3%81%AE%E5%85%B1%E7%94%A8%E6%A9%9F%E5%99%A8%E3%81%AF%E3%80%81%E3%81%93%E3%81%A1%E3%82%89%20%E3%81%8B%E3%82%89%E3%81%94%E7%A2%BA%E8%AA%8D%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82%20%E2%80%BB%E3%82%A8%E3%82%AF%E3%82%BB%E3%83%AB%E5%BD%A2%E5%BC%8F%E3%81%AF%E3%80%81%2021%E3%81%8B%E3%82%89) 。機関によっては設備一覧をExcel等で配布している場合があります。利用可能ならこれを直接解析した方がHTMLより確実です。そういったデータがないか各機関サイトを調査します。
	- 収集対象サイトの優先順位は「国立研究機関（産総研、NIMS など）＞国立大学（東京大学、東北大学、新潟大学 など）＞私立大学（早稲田大学、慶應義塾大学 など）＞高等専門学校（仙台高専、長岡技術大学 など）」とします。
	- 収集対象サイトの初期リスト（優先度・URL・データ形式）は以下の通りです（共用設備ページの詳細URLは調査で確定し、更新します）。
		| 優先度 | サイト/機関 | URL | 想定データ形式 | 補足 |
		| --- | --- | --- | --- | --- |
		| P0 | 産総研 (AIST) | https://www.aist.go.jp/ | HTML/PDF (共用設備ページ想定) | 共用設備ページを要調査 |
		| P0 | 物質・材料研究機構 (NIMS) | https://www.nims.go.jp/ | HTML/PDF (共用設備ページ想定) | 共用設備ページを要調査 |
		| P1 | 東京大学 | https://www.u-tokyo.ac.jp/ | HTML/CSV (大学サイト公開一覧) | 共用設備一覧ページを要調査 |
		| P1 | 東北大学 | https://www.tohoku.ac.jp/ | HTML/CSV (大学サイト公開一覧) | 共用設備一覧ページを要調査 |
		| P1 | 新潟大学 | https://www.niigata-u.ac.jp/ | HTML/CSV (大学サイト公開一覧) | 共用設備一覧ページを要調査 |
		| P2 | 早稲田大学 | https://www.waseda.jp/ | HTML/CSV (大学サイト公開一覧) | 共用設備一覧ページを要調査 |
		| P2 | 慶應義塾大学 | https://www.keio.ac.jp/ | HTML/CSV (大学サイト公開一覧) | 共用設備一覧ページを要調査 |
		| P3 | 仙台高専 | https://www.sendai-nct.ac.jp/ | HTML/PDF (機器一覧ページ想定) | 共用設備一覧ページを要調査 |
		| P3 | 長岡工業高専 | https://www.nagaoka-ct.ac.jp/ | HTML/PDF (機器一覧ページ想定) | 名称/対象は要確認 |
	- 上記のアプローチごとの利点・課題を整理し、 **優先ルート** を決めます。例えば国立研究機関・国立大学を優先取得し、私立大学や高専は個別ページを補完的に回るなどの戦略を立てます。
	- クローリング対象のURLリストを作成します。各機関サイトの一覧/検索ページのURL構造やページング方式を調べ、全設備を取得する方法を確認します。個別大学サイトの場合、各大学名のリストからURLを推定・探索します（スクレイピングスクリプトでGoogle検索APIを使って「◯◯大学 共用機器」などを探すことも検討）。
4. **スクレイピングスクリプト開発**
	- Python環境をセットアップし、Requestsまたはaiohttp等でHTTPアクセス、BeautifulSoup等でHTML解析を行うコードを書き始めます。初めに1サイト（例: 京都大学の公開設備ページ）をターゲットに選び、そのHTMLを取得・パースして目的の情報を抽出する処理を実装します。抽出項目とFirestoreフィールドのマッピングを確認し、想定外の表記ゆれ（例えば「利用料：無料（ただし試薬代実費）」のようなケースでfee\_bandをどう判定するか等）に対応します。
	- 続いて他のサイトにも対応できるよう、サイトごとに **パーサークラス** ないし関数を用意します。それぞれのサイト固有のHTML構造（テーブルになっている、箇条書きになっている等）に応じてXPathやCSSセレクタで必要情報を取り出します。共通部分（文字列正規化や、住所補完、データ型変換など）はユーティリティ関数化します。
	- Firestoreへの書き込みを行うコードを組み込みます。Pythonの場合、Firestore用のFirebase Admin SDKを使って直接ドキュメントを作成/更新できます。あるいはFirestoreのREST APIにHTTPでPOST/PUTする方法もあります。ここではPython + Admin SDKを採用し、サービスアカウントキー(JSON)を用いて認証し、スクリプトからFirestoreにアクセスします。
	- **データ更新ロジック**: 取得した1件の設備データについて、まず `dedupe_key` を生成しFirestoreで既存照会します。既存レコードがあれば、そのドキュメントIDを取得し `update` を実行、なければ `add` で新規作成します。更新の際は `crawled_at` を現在時刻に変更し、他のフィールドも新情報で上書きします（ただし、例えば別ソースから得た情報で欠損補完していたフィールドがある場合、それを上書きして空にしてしまわないよう、NULLの項目は上書きしない等の工夫をします）。
	- **削除検出**: 全ての取得処理が終わった後、オプションで削除候補検出処理を行います。今回取得した全 `dedupe_key` の集合を保持し、Firestore内の全ドキュメントの `dedupe_key` と比較します。Firestoreからすべてのキーを取得するクエリを実行し（件数次第では分割）、差分を取ります。差分に該当するレコードは情報源から消滅した可能性が高いため、それらのドキュメントにフラグを立てるか削除を行います。いきなり物理削除するのが不安な場合は、ドキュメントに `deleted: true` のフィールドを付与し、通常のクエリでは除外するようにする方法もあります。開発初期は誤削除防止のためフラグ方式で動作させ、慣れてきたら物理削除に切り替える方針でも良いでしょう。
	- **住所取得統合**: スクリプト内で、各レコードのorg\_nameに対して住所検索を行います。前準備として全国大学住所データCSVを読み込み、org\_name（正規化した名前、例えば「山形大学医学部附属病院」→「山形大学」など対応づけ）でハッシュマップを作ります。まずこのマップから住所が取れれば `address_raw` に設定します。見つからない場合のみGoogle Geocoding APIにリクエストを飛ばし、戻り値の住所を使用します（併せて緯度経度も取得できますが、本システムでは当面使わないため保存は任意）。API結果を得たら、次回以降のためにその機関名と住所をローカルキャッシュやFirestoreの別コレクション（org\_info等）に保存しておきます。
	- **単体テスト**: 各情報源ごとに、実際にHTTPアクセスせずに保存しておいたHTMLサンプル（もしくは小規模範囲のみ取得）でパーサーのテストを行います。想定通りフィールドが抽出できるか、特殊ケース（例えば料金が「※お問い合わせください」と書かれている等）に対処できているかを確認します。
5. **データ取得の試行と調整**
	- 実装したクローラを実際に実行し、主要なデータソースから **試験的にデータを取得** します。例えば主要大学サイトから100件程度、大学個別サイトからいくつか、Firestoreに投入してみます。
	- Firestore上でデータを確認し、フィールドに不整合がないかチェックします。特に、文字列エンコーディング（全角半角の揺れ）、改行やHTMLタグが混入していないか、カテゴリ名や機関名が想定の形式になっているかに注目します。必要に応じてパーサーでの正規化処理を強化します（例: 全角数字を半角に統一、末尾の句点を削除、機器名に機関名が含まれる場合は分離 など）。
	- 複数ソース間で同一 `dedupe_key` が発生するケースを検証します。もし同じ設備が異なるソースから取得された場合、Firestore側できちんと1件にまとまっているか（上書き処理が働いているか）を確認します。また、上書きの結果、フィールドが欠損してしまっていないか（どちらかのソースで空欄の値に上書きされて有用な情報が消えてしまわないように）ロジックを点検します。必要なら、 **マージ戦略** （例えば外部利用可否は「可」が一つでもあれば可とするとか、ソース更新日が新しい方のデータを優先するとか）を検討します。ただし複雑になるようなら当初は単純な上書きで割り切り、データ品質を人手でチェックします。
	- 住所情報の精度を確認します。自動付与した住所が実際の設備設置場所と大きくズレていないかをサンプルチェックします。例えば「○○大学 病院キャンパス」の設備に対して本部住所（別キャンパスの住所）が入ってしまうケースなどが考えられますが、現状「機器の所在地は公的機関の所在地で構わない」との前提なので許容範囲か確認します。大きな問題がなければこの仕様で進めます。
	- UIで使用するデータ形式が十分か検討します。例えば住所をそのまま表示すると長すぎる場合、市区町村までと番地以降を分けたくなるかもしれません。その場合フィールドを分割するか、表示時に処理するかを決めます（フィールド追加はこの時点までなら調整容易です）。
	- 試行で問題が出尽くしたら、全情報源に対してフルクローリングを行い、Firestoreに **初期データセット** を構築します。件数の目安としては数百～数千件になる見込みです。Firestore利用料金やパフォーマンスにも問題ない量です。
6. **フロントエンド実装**
	- Reactアプリケーションを作成します。 `create-react-app` 等のツールでプロジェクトを生成し、Firebase SDKをインストールします（ `npm install firebase` ）。Firebase設定（apiKeyやprojectIdなど）は環境毎に設定し、開発時はテスト用Firestoreに接続します。
	- アプリのページ構成を設計します。シンプルな構成としては、メインとなる検索・一覧ページ（ルートパス "/")と、詳細ページ("/equipment/:id")の2種類です。React Routerを導入してルーティングを設定します。カード上の「詳細を見る」クリックで詳細ページへ遷移する流れとします（もしくはModal表示ならルーティング不要ですが、ここではSEOも考慮してページ遷移式にします）。
	- グローバルなUI要素（ヘッダー、フッター、ナビゲーション）を作成します。ヘッダーにはサイトタイトル（例：「研究設備共用データベース」仮称）や簡単な説明、フッターには利用上の注意や問い合わせ先リンクを配置します。
	- **検索フォームUI**: ページ上部に検索条件フォームを配置します。Reactの状態管理（useState等）で、選択されたカテゴリ・地域・キーワード・フィルタを保持します。カテゴリ選択はプルダウン（大分類を選ぶと自動的に詳細分類プルダウンが絞られる等の二段階も可）、地域はプルダウン（全国、地方、都道府県をツリー状にしても良いですが、実装簡素化のため都道府県一覧を直接表示でもOK）、利用可否・料金フィルタはチェックボックス（「外部利用可のみ」「無料のみ」）で提供します。キーワード入力欄はテキストボックスです。
	- **Firestoreクエリ実装**: 検索条件に応じてFirestoreからデータを取得する処理を実装します。Firebase SDKのFirestoreモジュールを用い、例えば `query(collection(db, "equipment"), where("prefecture", "==", selectedPref), where("category_general","==", selectedCat))` のようにクエリを構築します。キーワード検索は部分一致非対応のため、入力値が空でない場合は簡易に `where("name", "==", keyword)` （完全一致）や `startAt/endAt` による前方一致検索も検討します。完全一致でヒットしない場合のUXとして、全件クライアントフィルタを走らせる等のフォールバックを用意します。
	- Firestoreから取得したデータはReactのstateに保持し、それを元に一覧レンダリングします。一覧はカードコンポーネントを用意し、受け取ったequipmentデータオブジェクトの主要項目を表示します（コンポーネントに渡すpropsとして各フィールド）。この際、外部利用可否や料金はアイコン＋テキスト、住所は都道府県＋「...」で適度に省略、などデザインします。
	- **詳細ページ実装**: URL上の:idパラメータからFirestoreの該当ドキュメントを取得します。 `getDoc(doc(db, "equipment", id))` で単一取得が可能です。取得したデータを表示するコンポーネントを作り込みます。項目ごとに整然とレイアウトし、長いテキスト（条件等）は改行保持または箇条書き表示にします。住所の横に地図リンク（Google Mapsの該当住所検索URL）を設置します。例えば `https://www.google.com/maps/search/?api=1&query=<エンコードした住所>` というURLを生成し、新規タブで開くようにします。
	- **UIデザイン仕上げ**: Material-UI (MUI) などを使っている場合はそのコンポーネントでだいたい整っていますが、細部を調整します。レスポンシブ対応として、CSSメディアクエリまたはMUIのGridコンポーネント設定で、幅狭い時は1カラムリスト、広い時は2～3カラムのカードグリッドにします。検索フォームもモバイルではアコーディオン内に格納してスペースを節約するなど工夫します。
	- **フロントエンド動作確認**: ローカル開発環境でFirestoreにテストデータを入れた状態で、実際に検索→結果表示→詳細表示の流れを検証します。フィルタの組み合わせが正しく結果に反映されるか、0件時のメッセージ、ロード中インジケータ（ローディングスピナー）表示、などUX面も確認します。不具合やUIの不備があれば修正します。
7. **総合テスト**
	- **機能テスト**: フロントエンドとバックエンドを統合して、シナリオ通り動作するか確認します。例えば以下のようなテストを行います:
		- 新規設備データをソース側に追加（もしくはテスト用ソースを用意）し、クローリング実行 -> Firestoreに反映 -> フロントで検索時に出現、まで通るか。
		- 学外利用可否などフィルタ条件の効き具合をテスト。データを意図的に「可」「不可」混在させて、フィルタ結果から外れる・残るが期待通りかを見る。
		- 住所リンクをクリックして正しくGoogle Mapsが開くか。住所の文字列が問題なくマップ検索可能な形式になっているか（全角→半角、不要情報含んでいないか）。
		- 外部リンク（source\_url）をクリックして、それぞれ正しい情報源ページに飛べることを確認。リンク切れや間違ったURLでないか、必要に応じてデータ側修正。
	- **UX/表示確認**: 様々なブラウザ（Chrome、Firefox、Safari、Edge等）とデバイス（PC、スマホ）で画面表示を確認します。レイアウト崩れがないか、日本語の文字化けがないか、レスポンシブ対応が機能しているかチェックします。特にスマホ表示で一覧が見づらくないか、タップしやすいかも評価し、スタイル調整します。
		- 日本語テキストの適切な改行やエスケープを確認します。長い機器名や条件文がUIをはみ出さないようCSSで制御します。
	- **性能テスト**: ダミーデータを大量投入し、検索や画面描画の速度を確認します。例えば1万件程度のドキュメントを用意し、Firestoreクエリのレスポンス時間や、クライアントでのレンダリング負荷を測定します。必要であれば、ページネーションの導入（FirestoreのstartAfter/endBeforeを使った前後ページ取得）や、検索結果を一定数で区切る機能を追加します。現在の要件規模では即時性に問題ない見込みですが、念のため負荷に耐えられることを示します。
	- **セキュリティテスト**: 意図しない操作ができないか検証します。例えばブラウザの開発者ツールからFirestoreへの書き込みを試みてブロックされること、FirestoreのREST APIエンドポイントに直接POSTしても認証エラーになることなどを確認します。また、Firestoreルールで想定外に読み取れてはいけないデータ（万一管理用の隠しコレクション等作った場合）が公開設定になっていないか点検します。さらに、フォーム入力箇所におけるXSS対策（基本的にReactはエスケープするので問題ない）などもチェックします。
	- **異常系テスト**: ネットワークが不安定な状態でページを開いた場合や、Firestoreがエラーを返した場合の挙動も確認します。読み込み失敗時にエラーメッセージを表示する実装を入れていればその表示確認、無ければユーザが操作をリトライできるようガイドするなどの対策検討をします。
	- テスト中に発見されたバグや要調整事項はIssueに記録し、修正・再テストを繰り返します。すべての重要なテスト項目をパスしたら、リリース準備に移ります。
8. **デプロイとリリース**
	- **バックエンドデプロイ**: クローリング用スクリプトをクラウド環境に配置します。Python + Cloud Runの場合、Dockerイメージをビルドし、 `gcloud` コマンドでデプロイします。トリガーはCloud Schedulerで設定し、例えば「月初午前3時にHTTP呼び出し」するようジョブを作成します（Cloud SchedulerからCloud Runの場合、認証トークンの扱いに注意し、必要ならばCloud Runサービスを公開またはSchedulerにサービスアカウント付与）。Node.js + Firebase Functionsの場合、 `firebase deploy --only functions` で関数をアップし、同時にFirebaseの定期実行（pub/subスケジューラ）を設定します。いずれにせよ、一度本番環境で手動実行し、正常終了とFirestore更新を確認します。
	- **フロントエンドデプロイ**: ビルド済みのフロントエンド（Reactアプリ）をFirebase Hostingにデプロイします（ `npm run build` 後、 `firebase deploy --only hosting` ）。カスタムドメインを使用する場合はドメイン設定とSSL認証の自動取得を行います。デプロイ後、実際のホスティングURLにアクセスし、本番Firestoreのデータを表示できることを確認します。
	- **本番初期データ投入**: テスト環境で問題がなければ、本番Firestoreに対して改めて **全情報源クローリングを実行** し、最新データを満たします。運用開始時点でできる限り最新になるよう調整します。
	- **アクセス制御の最終調整**: セキュリティルールを本番用に厳格化します（書き込み禁止など）。また、Firestoreのバックアップ機能を有効化し、誤操作や不具合でデータが消えても復旧できるようにしておきます（週1でエクスポートする設定等）。
	- **関係者レビューと承認**: リリース前に、関係者（プロジェクトオーナーや想定ユーザ）にステージングサイトで最終確認してもらいます。要求を満たしているか、使い勝手は良いかフィードバックをもらい、必要があれば軽微な修正を適用します。
	- **正式公開**: 上記を終え、問題なければ関係者の合意のもと正式にサイトを公開とします。ユーザへの告知（例えば関係する研究者コミュニティへの案内や、元データ提供元との連携など）を行い、利用を促進します。
9. **運用・保守計画**
	- **定期モニタリング**: 開発者または運用担当者は、Cloud Scheduler/Functionsの実行ログを月次でチェックし、失敗がないことを確認します。万一失敗していた場合、原因を調査し迅速に修正します（例えば情報源サイトの変更に伴うパーサ修正など）。
	- **問い合わせ対応**: 利用者からサイト経由またはメールで問い合わせが来た場合、内容を確認し対応します。設備詳細の誤り指摘などがあれば、元データと照合し、必要ならデータ修正や今後のクローラ改善に反映します。
	- **データ更新の調整**: 学外利用可能設備は年度ごとに内容更新される可能性があります。年度初め等、データ変動が大きいタイミングでは更新頻度を上げる（例えば4月は毎週実行する）などの運用も検討します。逆に安定してくれば隔月に減らすことも可能です。運用しながら適切な頻度を判断します。
	- **機能改善計画**: リリース後のフィードバックを踏まえ、機能追加・改善を継続的に行います。例として、「地図上で設備を探す機能」（取得済みの緯度経度を利用しGoogle Maps表示）や「設備のお気に入り登録機能」（ユーザアカウントを導入しブックマーク可能に）など、次段階の要望を整理します。ただし当初の要件範囲を超えるものは優先度を検討し、必要なら追加要件定義書を作成して対応します。

以上の計画に沿って開発を進めていけば、 **詳細な要件定義に基づいた着実な実装** が可能です。各ステップ完了時にレビューとテストを行い、段階的に品質を確保しながらプロジェクトを進めます。開発チーム内でタスクを分担しつつ、進捗を見える化して適宜調整することで、スムーズな開発とリリースを実現します。

**補足**: スケジュール感としては、要件定義確定後、開発とテストにおよそ2ヶ月程度を見込んでいます（チームの規模と経験にもよります）。以下は参考のマイルストンです:

- *Week 1-2*: 設計・環境構築完了、クローラ基本部分とデータスキーマ準備
- *Week 3-4*: クローラ実装・テスト完了（主要ソース対応）、Firestore初期データ揃う
- *Week 5-6*: フロントエンド実装・テスト完了、UIレビュー反映
- *Week 7*: 総合テスト・微修正、本番環境セットアップ
- *Week 8*: リリース・運用開始（バッファ期間含む）

このタイムラインはあくまで目安ですが、本ドキュメントで定義した内容に従い進めることで、大きな手戻りなく開発を完了できる見通しです。プロジェクトメンバー全員が本要件定義書と開発計画を共有認識することで、実装段階でも要件漏れや解釈違いを防ぎ、効率的に開発を進められるでしょう。今後は本書を常に参照・更新しながら、変化する要件や課題にも対応していきます。成功裡なシステム構築に向け、着実に開発を進めていきましょう。

**参考文献・情報源**: 本システムの要件定義にあたり、各大学の共用機器公開情報 [yamaguchi-u.ac.jp](https://www.yamaguchi-u.ac.jp/facility/sharing/guest/#:~:text=%E3%81%BE%E3%81%9F%E3%80%81%E5%90%84%E6%96%BD%E8%A8%AD%E3%81%AE%E3%83%9B%E3%83%BC%E3%83%A0%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E3%81%94%E7%A2%BA%E8%AA%8D%E3%81%84%E3%81%9F%E3%81%A0%E3%81%8D%E3%80%81%E6%96%BD%E8%A8%AD%E3%81%AB%E7%9B%B4%E6%8E%A5%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E3%81%84%E3%81%9F%E3%81%A0%E3%81%8F%E3%81%93%E3%81%A8%E3%82%82%E5%8F%AF%E8%83%BD%E3%81%A7%E3%81%99%E3%80%82) やFirestoreの設計ガイド [zenn.dev](https://zenn.dev/yucatio/articles/173f386c471398#:~:text=%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%81%AEjoin%20%3A%20%C3%97) 、大学所在地データセット [amano-tec.com](https://amano-tec.com/data/univs.html#:~:text=2023%E5%B9%B4%EF%BC%88%E4%BB%A4%E5%92%8C5%E5%B9%B4%EF%BC%891%E6%9C%881%E6%97%A5%E7%8F%BE%E5%9C%A8%E3%81%AE%E6%97%A5%E6%9C%AC%E5%9B%BD%E5%86%85%E5%A4%A7%E5%AD%A6813%E6%A0%A1%EF%BC%8C%E7%9F%AD%E5%A4%A7306%E6%A0%A1%EF%BC%8C%E5%A4%A7%E5%AD%A6%E6%A0%A17%E6%A0%A1%EF%BC%8C%E8%A8%881%2C126%E6%A0%A1%E3%81%AE%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E4%B8%80%E8%A6%A7%E3%83%87%E3%83%BC%E3%82%BF%E3%81%A7%E3%81%99%E3%80%82%E4%BD%8D%E7%BD%AE%E6%83%85%E5%A0%B1%E3%81%A8%E3%81%97%E3%81%A6%E4%B8%BB%E3%81%AB%E5%A4%A7%E5%AD%A6%E6%9C%AC%E9%83%A8%E3%82%92%E6%9C%89%E3%81%99%E3%82%AD%E3%83%A3%20%E3%83%B3%E3%83%91%E3%82%B9%E3%81%BE%E3%81%9F%E3%81%AF%E5%BB%BA%E7%89%A9%E3%82%92%E3%82%B8%E3%82%AA%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82%E5%B1%9E%E6%80%A7%E9%A0%85%E7%9B%AE%E3%81%AF%E9%80%A3%E7%95%AA%EF%BC%8C%E7%A7%91%E5%AD%A6%E7%A0%94%E7%A9%B6%E8%B2%BB%E5%8A%A9%E6%88%90%E4%BA%8B%E6%A5%AD%E3%81%AB%E4%BF%82%E3%82%8B%E6%A9%9F%E9%96%A2%E7%95%AA%E5%8F%B7%EF%BC%88%E5%A4%A7%E5%AD%A6%E7%95%AA%E5%8F%B7%EF%BC%89%EF%BC%8C%E6%96%87%E9%83%A8%E7%A7%91%E5%AD%A6%E7%9C%81%E5%AD%A6%E6%A0%A1%E3%82%B3%E3%83%BC%E3%83%89%EF%BC%8C%E5%A4%A7%E5%AD%A6%E5%90%8D%EF%BC%8C%E8%8B%B1%E8%AA%9E%E5%A4%A7%E5%AD%A6%E5%90%8D%EF%BC%8C%E9%83%B5%E4%BE%BF%E7%95%AA%E5%8F%B7%EF%BC%8C%20%E4%BD%8F%E6%89%80%EF%BC%8C%E9%9B%BB%E8%A9%B1%E7%95%AA%E5%8F%B7%EF%BC%8CURL%EF%BC%8C%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E5%90%8D%EF%BC%8C%E5%82%99%E8%80%83%EF%BC%8C%E7%B7%AF%E5%BA%A6%EF%BC%8C%E7%B5%8C%E5%BA%A6%EF%BC%8C%E4%BD%8F%E6%89%80%E3%81%AE%E5%8F%82%E7%85%A7%E5%85%83%E3%81%A7%E3%81%99%E3%80%82%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E5%90%8D%E3%81%AF1%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%91%E3%82%B9%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E7%A9%BA%E7%99%BD%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99%E3%80%82%E9%9B%BB%E8%A9%B1%E7%95%AA%E5%8F%B7%E3%81%AF%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%E3%81%8C%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AF%20%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%EF%BC%8C%E4%BB%A3%E8%A1%A8%E7%95%AA%E5%8F%B7%E3%81%8C%E3%81%AA%E3%81%84%E3%81%BE%E3%81%9F%E3%81%AF%E4%B8%8D%E6%98%8E%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E7%B7%8F%E5%8B%99%EF%BC%8C%E5%BA%B6%E5%8B%99%EF%BC%8C%E5%BA%83%E5%A0%B1%E3%81%AE%E9%A0%86%E3%81%AB%E8%A9%B2%E5%BD%93%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE%E3%82%92%E8%A8%98%E8%BC%89%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82) 等を参照しています。各種最新APIの仕様についてもGoogle Developersサイトで確認済みです。
